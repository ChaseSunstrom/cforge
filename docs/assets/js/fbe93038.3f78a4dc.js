"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[133],{8453:(e,n,r)=>{r.d(n,{R:()=>i,x:()=>a});var t=r(6540);const s={},c=t.createContext(s);function i(e){const n=t.useContext(c);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),t.createElement(c.Provider,{value:n},e.children)}},8800:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>o,contentTitle:()=>a,default:()=>d,frontMatter:()=>i,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"testing","title":"Testing & Benchmarking","description":"Testing","source":"@site/docs/testing.md","sourceDirName":".","slug":"/testing","permalink":"/cforge/docs/testing","draft":false,"unlisted":false,"editUrl":"https://github.com/chasesunstrom/cforge/edit/main/docs/docs/testing.md","tags":[],"version":"current","frontMatter":{"id":"testing","title":"Testing & Benchmarking"},"sidebar":"sidebar","previous":{"title":"Scripts & Hooks","permalink":"/cforge/docs/scripts-hooks"},"next":{"title":"Advanced Topics","permalink":"/cforge/docs/advanced-topics"}}');var s=r(4848),c=r(8453);const i={id:"testing",title:"Testing & Benchmarking"},a=void 0,o={},l=[{value:"Testing",id:"testing",level:2},{value:"Test Configuration",id:"test-configuration",level:3},{value:"Running Tests",id:"running-tests",level:3},{value:"Example Test File",id:"example-test-file",level:3},{value:"Benchmarking",id:"benchmarking",level:2},{value:"Configuration",id:"configuration",level:3},{value:"Supported Frameworks",id:"supported-frameworks",level:3},{value:"Running Benchmarks",id:"running-benchmarks",level:3},{value:"Example Benchmark (Google Benchmark)",id:"example-benchmark-google-benchmark",level:3},{value:"Example Benchmark (nanobench)",id:"example-benchmark-nanobench",level:3},{value:"Example Benchmark (Catch2)",id:"example-benchmark-catch2",level:3},{value:"Auto-Discovery",id:"auto-discovery",level:3},{value:"Output Format",id:"output-format",level:3},{value:"Tips",id:"tips",level:3}];function h(e){const n={code:"code",h2:"h2",h3:"h3",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,c.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h2,{id:"testing",children:"Testing"}),"\n",(0,s.jsx)(n.p,{children:"CForge integrates with CTest and supports multiple testing frameworks:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-toml",children:'[test]\r\nenabled = true\r\nframework = "catch2"  # catch2, gtest, doctest, boost\r\ndirectory = "tests"\r\ntimeout = 30  # seconds per test\n'})}),"\n",(0,s.jsx)(n.h3,{id:"test-configuration",children:"Test Configuration"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-toml",children:'[[tests.executables]]\r\nname = "math_tests"\r\nsources = ["tests/math_test.cpp"]\r\nincludes = ["include", "tests/common"]\r\nlinks = ["my_project"]\r\nlabels = ["unit", "math"]\n'})}),"\n",(0,s.jsx)(n.h3,{id:"running-tests",children:"Running Tests"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Run all tests\r\ncforge test\r\n\r\n# Run tests with a specific label\r\ncforge test --label unit\r\n\r\n# Run tests matching a pattern\r\ncforge test --filter math\r\n\r\n# Run in specific configuration\r\ncforge test -c Release\r\n\r\n# Initialize test directory with sample test\r\ncforge test --init\r\n\r\n# Discover tests and update config\r\ncforge test --discover\r\n\r\n# Generate test reports\r\ncforge test --report xml\r\n\r\n# Verbose output\r\ncforge test -v\n"})}),"\n",(0,s.jsx)(n.h3,{id:"example-test-file",children:"Example Test File"}),"\n",(0,s.jsxs)(n.p,{children:["Using Catch2 (",(0,s.jsx)(n.code,{children:"tests/math_test.cpp"}),"):"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-cpp",children:'#include <catch2/catch_test_macros.hpp>\r\n#include "my_project.h"\r\n\r\nTEST_CASE("Addition works correctly", "[math]") {\r\n    REQUIRE(my_project::add(2, 3) == 5);\r\n    REQUIRE(my_project::add(-1, 1) == 0);\r\n}\r\n\r\nTEST_CASE("Multiplication works correctly", "[math]") {\r\n    REQUIRE(my_project::multiply(2, 3) == 6);\r\n    REQUIRE(my_project::multiply(0, 5) == 0);\r\n}\n'})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"benchmarking",children:"Benchmarking"}),"\n",(0,s.jsx)(n.p,{children:"CForge provides integrated benchmarking support with multiple frameworks."}),"\n",(0,s.jsx)(n.h3,{id:"configuration",children:"Configuration"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-toml",children:'[benchmark]\r\ndirectory = "bench"              # Benchmark source directory\r\nframework = "google"             # google, nanobench, catch2\r\nauto_link_project = true         # Automatically link project library\n'})}),"\n",(0,s.jsx)(n.h3,{id:"supported-frameworks",children:"Supported Frameworks"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Framework"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Google Benchmark"})}),(0,s.jsx)(n.td,{children:"Industry-standard microbenchmarking library"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"nanobench"})}),(0,s.jsx)(n.td,{children:"Header-only, easy to integrate"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Catch2 BENCHMARK"})}),(0,s.jsx)(n.td,{children:"Use Catch2's built-in benchmarking macros"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"running-benchmarks",children:"Running Benchmarks"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Run all benchmarks\r\ncforge bench\r\n\r\n# Run matching benchmarks only\r\ncforge bench --filter 'BM_Sort'\r\n\r\n# Skip build step\r\ncforge bench --no-build\r\n\r\n# Output formats\r\ncforge bench --json > results.json\r\ncforge bench --csv > results.csv\r\n\r\n# Specific configuration (Release is default)\r\ncforge bench -c Release\r\n\r\n# Verbose output\r\ncforge bench -v\n"})}),"\n",(0,s.jsx)(n.h3,{id:"example-benchmark-google-benchmark",children:"Example Benchmark (Google Benchmark)"}),"\n",(0,s.jsxs)(n.p,{children:["Create ",(0,s.jsx)(n.code,{children:"bench/bench_main.cpp"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-cpp",children:"#include <benchmark/benchmark.h>\r\n#include <vector>\r\n#include <algorithm>\r\n\r\nstatic void BM_VectorPush(benchmark::State& state) {\r\n    for (auto _ : state) {\r\n        std::vector<int> v;\r\n        for (int i = 0; i < state.range(0); ++i) {\r\n            v.push_back(i);\r\n        }\r\n        benchmark::DoNotOptimize(v);\r\n    }\r\n}\r\nBENCHMARK(BM_VectorPush)->Range(8, 8<<10);\r\n\r\nstatic void BM_VectorReserve(benchmark::State& state) {\r\n    for (auto _ : state) {\r\n        std::vector<int> v;\r\n        v.reserve(state.range(0));\r\n        for (int i = 0; i < state.range(0); ++i) {\r\n            v.push_back(i);\r\n        }\r\n        benchmark::DoNotOptimize(v);\r\n    }\r\n}\r\nBENCHMARK(BM_VectorReserve)->Range(8, 8<<10);\r\n\r\nBENCHMARK_MAIN();\n"})}),"\n",(0,s.jsx)(n.h3,{id:"example-benchmark-nanobench",children:"Example Benchmark (nanobench)"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-cpp",children:'#define ANKERL_NANOBENCH_IMPLEMENT\r\n#include <nanobench.h>\r\n#include <vector>\r\n\r\nint main() {\r\n    ankerl::nanobench::Bench().run("vector push_back", [&] {\r\n        std::vector<int> v;\r\n        for (int i = 0; i < 1000; ++i) {\r\n            v.push_back(i);\r\n        }\r\n        ankerl::nanobench::doNotOptimizeAway(v);\r\n    });\r\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"example-benchmark-catch2",children:"Example Benchmark (Catch2)"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-cpp",children:'#include <catch2/catch_test_macros.hpp>\r\n#include <catch2/benchmark/catch_benchmark.hpp>\r\n#include <vector>\r\n\r\nTEST_CASE("Vector benchmarks", "[benchmark]") {\r\n    BENCHMARK("push_back 1000 elements") {\r\n        std::vector<int> v;\r\n        for (int i = 0; i < 1000; ++i) {\r\n            v.push_back(i);\r\n        }\r\n        return v;\r\n    };\r\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"auto-discovery",children:"Auto-Discovery"}),"\n",(0,s.jsx)(n.p,{children:"CForge automatically discovers benchmark files that:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Are located in the ",(0,s.jsx)(n.code,{children:"bench/"})," directory (or configured directory)"]}),"\n",(0,s.jsx)(n.li,{children:"Have 'bench' or 'perf' in the filename"}),"\n",(0,s.jsx)(n.li,{children:"Include a recognized benchmark framework header"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"output-format",children:"Output Format"}),"\n",(0,s.jsx)(n.p,{children:"Benchmark results are displayed in a table format:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\r\n\u2502                      Benchmark Summary                            \u2502\r\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\r\n\u2502 Benchmark                          Time           CPU   Iterations \u2502\r\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\r\n\u2502 BM_VectorPush/8                   45 ns         45 ns   15555556  \u2502\r\n\u2502 BM_VectorPush/64                 312 ns        312 ns    2240000  \u2502\r\n\u2502 BM_VectorReserve/8                28 ns         28 ns   25000000  \u2502\r\n\u2502 BM_VectorReserve/64              198 ns        198 ns    3555556  \u2502\r\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\r\n\r\nRan 4 benchmark(s) in 2.34s\r\n4 passed\n"})}),"\n",(0,s.jsx)(n.h3,{id:"tips",children:"Tips"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Use Release mode"}),": Benchmarks run in Release mode by default for accurate timing"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Warm-up"}),": Frameworks handle warm-up iterations automatically"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Consistency"}),": Run benchmarks on an idle system for consistent results"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Compare"}),": Use ",(0,s.jsx)(n.code,{children:"--json"})," output to compare results across runs"]}),"\n"]})]})}function d(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}}}]);