<UserControl x:Class="CforgeVS.DependencyToolWindowControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:vsshell="clr-namespace:Microsoft.VisualStudio.Shell;assembly=Microsoft.VisualStudio.Shell.15.0"
             xmlns:imaging="clr-namespace:Microsoft.VisualStudio.Imaging;assembly=Microsoft.VisualStudio.Imaging"
             xmlns:catalog="clr-namespace:Microsoft.VisualStudio.Imaging;assembly=Microsoft.VisualStudio.ImageCatalog"
             xmlns:theming="clr-namespace:Microsoft.VisualStudio.PlatformUI;assembly=Microsoft.VisualStudio.Imaging"
             xmlns:local="clr-namespace:CforgeVS"
             mc:Ignorable="d"
             d:DesignHeight="600" d:DesignWidth="400"
             Background="{DynamicResource {x:Static vsshell:VsBrushes.ToolWindowBackgroundKey}}"
             Foreground="{DynamicResource {x:Static vsshell:VsBrushes.ToolWindowTextKey}}"
             theming:ImageThemingUtilities.ImageBackgroundColor="{DynamicResource {x:Static vsshell:VsColors.ToolWindowBackgroundKey}}">

    <UserControl.Resources>
        <!-- TreeView Item Style -->
        <Style x:Key="DependencyTreeItemStyle" TargetType="TreeViewItem">
            <Setter Property="IsExpanded" Value="True"/>
            <Setter Property="Padding" Value="2,1"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Foreground" Value="{DynamicResource {x:Static vsshell:VsBrushes.ToolWindowTextKey}}"/>
        </Style>

        <!-- Toolbar Button Style -->
        <Style x:Key="ToolbarBtn" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="Transparent"/>
            <Setter Property="Padding" Value="4,2"/>
            <Setter Property="Margin" Value="1"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Foreground" Value="{DynamicResource {x:Static vsshell:VsBrushes.CommandBarTextActiveKey}}"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="{DynamicResource {x:Static vsshell:VsBrushes.CommandBarMouseOverBackgroundGradientKey}}"/>
                    <Setter Property="BorderBrush" Value="{DynamicResource {x:Static vsshell:VsBrushes.CommandBarBorderKey}}"/>
                </Trigger>
                <Trigger Property="IsPressed" Value="True">
                    <Setter Property="Background" Value="{DynamicResource {x:Static vsshell:VsBrushes.CommandBarMouseDownBackgroundGradientKey}}"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Small Button Style -->
        <Style x:Key="SmallBtn" TargetType="Button">
            <Setter Property="Padding" Value="8,3"/>
            <Setter Property="Margin" Value="2"/>
            <Setter Property="FontSize" Value="11"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Background" Value="{DynamicResource {x:Static vsshell:VsBrushes.CommandBarGradientKey}}"/>
            <Setter Property="Foreground" Value="{DynamicResource {x:Static vsshell:VsBrushes.CommandBarTextActiveKey}}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource {x:Static vsshell:VsBrushes.CommandBarBorderKey}}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="{DynamicResource {x:Static vsshell:VsBrushes.CommandBarMouseOverBackgroundGradientKey}}"/>
                </Trigger>
                <Trigger Property="IsPressed" Value="True">
                    <Setter Property="Background" Value="{DynamicResource {x:Static vsshell:VsBrushes.CommandBarMouseDownBackgroundGradientKey}}"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- TextBox Style for SearchBox -->
        <Style x:Key="ThemedTextBox" TargetType="TextBox">
            <Setter Property="Background" Value="{DynamicResource {x:Static vsshell:VsBrushes.ComboBoxBackgroundKey}}"/>
            <Setter Property="Foreground" Value="{DynamicResource {x:Static vsshell:VsBrushes.WindowTextKey}}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource {x:Static vsshell:VsBrushes.ComboBoxBorderKey}}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="CaretBrush" Value="{DynamicResource {x:Static vsshell:VsBrushes.WindowTextKey}}"/>
        </Style>

        <!-- TabControl Style -->
        <Style x:Key="ThemedTabControl" TargetType="TabControl">
            <Setter Property="Background" Value="{DynamicResource {x:Static vsshell:VsBrushes.ToolWindowBackgroundKey}}"/>
            <Setter Property="BorderThickness" Value="0"/>
        </Style>

        <!-- TabItem Style with ControlTemplate for proper theming -->
        <Style x:Key="ThemedTabItem" TargetType="TabItem">
            <Setter Property="Foreground" Value="{DynamicResource {x:Static vsshell:VsBrushes.CommandBarTextActiveKey}}"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TabItem">
                        <Border x:Name="Border"
                                Background="{DynamicResource {x:Static vsshell:VsBrushes.CommandBarGradientKey}}"
                                BorderBrush="{DynamicResource {x:Static vsshell:VsBrushes.CommandBarBorderKey}}"
                                BorderThickness="1,1,1,0"
                                Padding="12,6"
                                Margin="0,0,2,0"
                                CornerRadius="2,2,0,0">
                            <ContentPresenter x:Name="ContentSite"
                                              ContentSource="Header"
                                              HorizontalAlignment="Center"
                                              VerticalAlignment="Center"
                                              TextBlock.Foreground="{DynamicResource {x:Static vsshell:VsBrushes.CommandBarTextActiveKey}}"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter TargetName="Border" Property="Background"
                                        Value="{DynamicResource {x:Static vsshell:VsBrushes.ToolWindowBackgroundKey}}"/>
                                <Setter TargetName="Border" Property="BorderBrush"
                                        Value="{DynamicResource {x:Static vsshell:VsBrushes.ToolWindowBorderKey}}"/>
                                <Setter TargetName="ContentSite" Property="TextBlock.Foreground"
                                        Value="{DynamicResource {x:Static vsshell:VsBrushes.ToolWindowTextKey}}"/>
                                <Setter TargetName="ContentSite" Property="TextBlock.FontWeight" Value="SemiBold"/>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Border" Property="Background"
                                        Value="{DynamicResource {x:Static vsshell:VsBrushes.CommandBarMouseOverBackgroundGradientKey}}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </UserControl.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Toolbar -->
        <Border Grid.Row="0" Background="{DynamicResource {x:Static vsshell:VsBrushes.CommandBarGradientKey}}"
                BorderBrush="{DynamicResource {x:Static vsshell:VsBrushes.CommandBarBorderKey}}" BorderThickness="0,0,0,1">
            <StackPanel Orientation="Horizontal" Margin="4,2">
                <Button Style="{StaticResource ToolbarBtn}" Click="AddButton_Click" ToolTip="Add dependency">
                    <StackPanel Orientation="Horizontal">
                        <imaging:CrispImage Width="16" Height="16" Moniker="{x:Static catalog:KnownMonikers.Add}"/>
                        <TextBlock Text="Add" Margin="4,0,0,0" VerticalAlignment="Center"/>
                    </StackPanel>
                </Button>
                <Button Style="{StaticResource ToolbarBtn}" Click="RemoveButton_Click" ToolTip="Remove selected">
                    <StackPanel Orientation="Horizontal">
                        <imaging:CrispImage Width="16" Height="16" Moniker="{x:Static catalog:KnownMonikers.Cancel}"/>
                        <TextBlock Text="Remove" Margin="4,0,0,0" VerticalAlignment="Center"/>
                    </StackPanel>
                </Button>

                <Border Width="1" Margin="6,4" Background="{DynamicResource {x:Static vsshell:VsBrushes.CommandBarMenuSeparatorKey}}"/>

                <Button Style="{StaticResource ToolbarBtn}" Click="RefreshButton_Click" ToolTip="Refresh">
                    <imaging:CrispImage Width="16" Height="16" Moniker="{x:Static catalog:KnownMonikers.Refresh}"/>
                </Button>
                <Button Style="{StaticResource ToolbarBtn}" Click="UpdateRegistryButton_Click" ToolTip="Update registry"><imaging:CrispImage Width="16" Height="16" Moniker="{x:Static catalog:KnownMonikers.CloudDownload}"/>
                </Button>
                <Button Style="{StaticResource ToolbarBtn}" Click="OutdatedButton_Click" ToolTip="Check for updates">
                    <imaging:CrispImage Width="16" Height="16" Moniker="{x:Static catalog:KnownMonikers.Sync}"/>
                </Button>
            </StackPanel>
        </Border>

        <!-- Search Box -->
        <Border Grid.Row="1" Background="{DynamicResource {x:Static vsshell:VsBrushes.CommandBarGradientKey}}"
                BorderBrush="{DynamicResource {x:Static vsshell:VsBrushes.CommandBarBorderKey}}" BorderThickness="0,0,0,1"
                Padding="8,4">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <TextBox x:Name="SearchBox" Grid.Column="0"
                         Style="{StaticResource ThemedTextBox}"
                         VerticalContentAlignment="Center"
                         Padding="4,3"
                         KeyDown="SearchBox_KeyDown"/>
                <Button Grid.Column="1" Style="{StaticResource ToolbarBtn}" Click="SearchButton_Click" Margin="4,0,0,0">
                    <imaging:CrispImage Width="16" Height="16" Moniker="{x:Static catalog:KnownMonikers.Search}"/>
                </Button>
            </Grid>
        </Border>

        <!-- Main Content - TabControl -->
        <TabControl Grid.Row="2" x:Name="MainTabControl"
                    Style="{StaticResource ThemedTabControl}">
            <!-- Installed Dependencies Tab -->
            <TabItem Header="Installed" Style="{StaticResource ThemedTabItem}">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <TreeView x:Name="DependencyTree" Grid.Row="0"
                              Background="{DynamicResource {x:Static vsshell:VsBrushes.ToolWindowBackgroundKey}}"
                              BorderThickness="0"
                              Padding="4"
                              ItemContainerStyle="{StaticResource DependencyTreeItemStyle}"
                              SelectedItemChanged="DependencyTree_SelectedItemChanged">
                        <TreeView.ItemTemplate>
                            <HierarchicalDataTemplate ItemsSource="{Binding Children}">
                                <StackPanel Orientation="Horizontal" Margin="0,2">
                                    <!-- Icon -->
                                    <imaging:CrispImage Width="16" Height="16" Margin="0,0,6,0"
                                                        Moniker="{Binding ImageMoniker}"/>
                                    <!-- Name -->
                                    <TextBlock Text="{Binding Name}" FontWeight="SemiBold" VerticalAlignment="Center"
                                               Foreground="{DynamicResource {x:Static vsshell:VsBrushes.ToolWindowTextKey}}"/>
                                    <!-- Version -->
                                    <TextBlock x:Name="VersionText" Text=" @ "
                                               Foreground="{DynamicResource {x:Static vsshell:VsBrushes.GrayTextKey}}"/>
                                    <TextBlock Text="{Binding Version}" Foreground="#0097A7"/>
                                    <!-- Type indicator -->
                                    <Border x:Name="TypeBadge" CornerRadius="2" Padding="4,1" Margin="6,0,0,0"
                                            Background="{DynamicResource {x:Static vsshell:VsBrushes.CommandBarGradientKey}}">
                                        <TextBlock Text="{Binding Type}" FontSize="10"
                                                   Foreground="{DynamicResource {x:Static vsshell:VsBrushes.GrayTextKey}}"/>
                                    </Border>
                                </StackPanel>
                                <HierarchicalDataTemplate.Triggers>
                                    <DataTrigger Binding="{Binding Type}" Value="group">
                                        <Setter TargetName="VersionText" Property="Visibility" Value="Collapsed"/>
                                        <Setter TargetName="TypeBadge" Property="Visibility" Value="Collapsed"/>
                                    </DataTrigger>
                                </HierarchicalDataTemplate.Triggers>
                            </HierarchicalDataTemplate>
                        </TreeView.ItemTemplate>
                        <TreeView.ContextMenu>
                            <ContextMenu>
                                <MenuItem Header="Copy Name" Click="CopyName_Click">
                                    <MenuItem.Icon>
                                        <imaging:CrispImage Width="16" Height="16" Moniker="{x:Static catalog:KnownMonikers.Copy}"/>
                                    </MenuItem.Icon>
                                </MenuItem>
                                <MenuItem Header="Copy with Version" Click="CopyNameVersion_Click"/>
                                <Separator/>
                                <MenuItem Header="Check for Updates" Click="CheckUpdate_Click">
                                    <MenuItem.Icon>
                                        <imaging:CrispImage Width="16" Height="16" Moniker="{x:Static catalog:KnownMonikers.Refresh}"/>
                                    </MenuItem.Icon>
                                </MenuItem>
                                <MenuItem Header="Update to Latest" Click="UpdateDependency_Click">
                                    <MenuItem.Icon>
                                        <imaging:CrispImage Width="16" Height="16" Moniker="{x:Static catalog:KnownMonikers.StatusOK}"/>
                                    </MenuItem.Icon>
                                </MenuItem>
                                <Separator/>
                                <MenuItem Header="Remove" Click="RemoveDependency_Click">
                                    <MenuItem.Icon>
                                        <imaging:CrispImage Width="16" Height="16" Moniker="{x:Static catalog:KnownMonikers.Cancel}"/>
                                    </MenuItem.Icon>
                                </MenuItem>
                                <Separator/>
                                <MenuItem Header="View in cforge.toml" Click="ViewInToml_Click">
                                    <MenuItem.Icon>
                                        <imaging:CrispImage Width="16" Height="16" Moniker="{x:Static catalog:KnownMonikers.ConfigurationFile}"/>
                                    </MenuItem.Icon>
                                </MenuItem>
                            </ContextMenu>
                        </TreeView.ContextMenu>
                    </TreeView>

                    <!-- Selected Package Details -->
                    <Border Grid.Row="1" x:Name="DetailsPanel"
                            Background="{DynamicResource {x:Static vsshell:VsBrushes.CommandBarGradientKey}}"
                            BorderBrush="{DynamicResource {x:Static vsshell:VsBrushes.CommandBarBorderKey}}"
                            BorderThickness="0,1,0,0"
                            Padding="12,8" Visibility="Collapsed">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock x:Name="DetailName" FontWeight="Bold" FontSize="13"
                                           Foreground="{DynamicResource {x:Static vsshell:VsBrushes.ToolWindowTextKey}}"/>
                                <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                                    <TextBlock Text="Installed: " Foreground="{DynamicResource {x:Static vsshell:VsBrushes.GrayTextKey}}" FontSize="11"/>
                                    <TextBlock x:Name="DetailVersion" Foreground="#0097A7" FontSize="11"/>
                                </StackPanel>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="Latest: " Foreground="{DynamicResource {x:Static vsshell:VsBrushes.GrayTextKey}}" FontSize="11"/>
                                    <TextBlock x:Name="DetailLatestVersion" Foreground="#4CAF50" FontSize="11"/>
                                </StackPanel>
                                <TextBlock x:Name="DetailType" Foreground="{DynamicResource {x:Static vsshell:VsBrushes.GrayTextKey}}" FontSize="11" FontStyle="Italic"/>
                            </StackPanel>
                            <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                <Button Content="Update" Style="{StaticResource SmallBtn}" Click="DetailUpdateButton_Click"/>
                                <Button Content="Remove" Style="{StaticResource SmallBtn}" Click="DetailRemoveButton_Click"/>
                                <Button Content="Info" Style="{StaticResource SmallBtn}" Click="DetailInfoButton_Click"/>
                            </StackPanel>
                        </Grid>
                    </Border>
                </Grid>
            </TabItem>

            <!-- Available Packages Tab -->
            <TabItem Header="Browse" Style="{StaticResource ThemedTabItem}">
                <Grid>
                    <ListBox x:Name="AvailablePackagesList"
                             Background="{DynamicResource {x:Static vsshell:VsBrushes.ToolWindowBackgroundKey}}"
                             BorderThickness="0"
                             ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                        <ListBox.ItemContainerStyle>
                            <Style TargetType="ListBoxItem">
                                <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                                <Setter Property="Padding" Value="0"/>
                                <Setter Property="Margin" Value="0"/>
                                <Setter Property="Background" Value="Transparent"/>
                                <Style.Triggers>
                                    <Trigger Property="IsSelected" Value="True">
                                        <Setter Property="Background" Value="{DynamicResource {x:Static vsshell:VsBrushes.HighlightKey}}"/>
                                    </Trigger>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Background" Value="{DynamicResource {x:Static vsshell:VsBrushes.CommandBarMouseOverBackgroundGradientKey}}"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </ListBox.ItemContainerStyle>
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <Border Padding="12,8" BorderBrush="{DynamicResource {x:Static vsshell:VsBrushes.CommandBarBorderKey}}"
                                        BorderThickness="0,0,0,1">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>

                                        <StackPanel Grid.Column="0">
                                            <StackPanel Orientation="Horizontal">
                                                <imaging:CrispImage Width="16" Height="16" Margin="0,0,8,0"
                                                                    Moniker="{x:Static catalog:KnownMonikers.NuGet}"/>
                                                <TextBlock Text="{Binding Name}" FontWeight="SemiBold" FontSize="12"
                                                           Foreground="{DynamicResource {x:Static vsshell:VsBrushes.ToolWindowTextKey}}"/>
                                                <TextBlock Text=" v" Foreground="{DynamicResource {x:Static vsshell:VsBrushes.GrayTextKey}}"
                                                           FontSize="11" VerticalAlignment="Center"/>
                                                <TextBlock Text="{Binding LatestVersion}" Foreground="#0097A7"
                                                           FontSize="11" VerticalAlignment="Center"/>
                                            </StackPanel>
                                            <TextBlock Text="{Binding Description}"
                                                       Foreground="{DynamicResource {x:Static vsshell:VsBrushes.GrayTextKey}}"
                                                       TextWrapping="Wrap" FontSize="11"
                                                       MaxWidth="280" Margin="24,2,0,0"/>
                                        </StackPanel>

                                        <Button Grid.Column="1" Style="{StaticResource SmallBtn}"
                                                Content="Install" VerticalAlignment="Center"
                                                Click="InstallPackage_Click" Tag="{Binding Name}"/>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>

                    <!-- Empty state -->
                    <StackPanel x:Name="NoPackagesText" HorizontalAlignment="Center" VerticalAlignment="Center">
                        <imaging:CrispImage Width="32" Height="32" Margin="0,0,0,12"
                                            Moniker="{x:Static catalog:KnownMonikers.Search}"
                                            HorizontalAlignment="Center"/>
                        <TextBlock Text="Search for packages"
                                   HorizontalAlignment="Center"
                                   Foreground="{DynamicResource {x:Static vsshell:VsBrushes.GrayTextKey}}"
                                   FontSize="13"/>
                        <TextBlock Text="fmt, spdlog, nlohmann_json, catch2, boost"
                                   HorizontalAlignment="Center"
                                   Foreground="{DynamicResource {x:Static vsshell:VsBrushes.GrayTextKey}}"
                                   FontSize="11" Margin="0,4,0,0"/>
                    </StackPanel>
                </Grid>
            </TabItem>

            <!-- Dependency Tree Tab -->
            <TabItem Header="Tree" Style="{StaticResource ThemedTabItem}">
                <Grid>
                    <Border Background="{DynamicResource {x:Static vsshell:VsBrushes.ToolWindowBackgroundKey}}">
                        <ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto">
                            <TextBox x:Name="DependencyTreeText"
                                     IsReadOnly="True"
                                     FontFamily="Cascadia Code, Consolas, Courier New"
                                     FontSize="12"
                                     Background="Transparent"
                                     Foreground="{DynamicResource {x:Static vsshell:VsBrushes.ToolWindowTextKey}}"
                                     BorderThickness="0"
                                     TextWrapping="NoWrap"
                                     Padding="8"/>
                        </ScrollViewer>
                    </Border>
                    <Button Style="{StaticResource SmallBtn}" Content="Refresh"
                            HorizontalAlignment="Right" VerticalAlignment="Top"
                            Margin="8" Click="RefreshTreeButton_Click"/>
                </Grid>
            </TabItem>

            <!-- Outdated Tab -->
            <TabItem Header="Updates" Style="{StaticResource ThemedTabItem}">
                <Grid>
                    <ListBox x:Name="OutdatedPackagesList"
                             Background="{DynamicResource {x:Static vsshell:VsBrushes.ToolWindowBackgroundKey}}"
                             BorderThickness="0"
                             ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                        <ListBox.ItemContainerStyle>
                            <Style TargetType="ListBoxItem">
                                <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                                <Setter Property="Padding" Value="0"/>
                                <Setter Property="Margin" Value="0"/>
                                <Setter Property="Background" Value="Transparent"/>
                                <Style.Triggers>
                                    <Trigger Property="IsSelected" Value="True">
                                        <Setter Property="Background" Value="{DynamicResource {x:Static vsshell:VsBrushes.HighlightKey}}"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </ListBox.ItemContainerStyle>
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <Border Padding="12,8" BorderBrush="{DynamicResource {x:Static vsshell:VsBrushes.CommandBarBorderKey}}"
                                        BorderThickness="0,0,0,1">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>

                                        <StackPanel Grid.Column="0">
                                            <StackPanel Orientation="Horizontal">
                                                <imaging:CrispImage Width="16" Height="16" Margin="0,0,8,0"
                                                                    Moniker="{x:Static catalog:KnownMonikers.StatusWarning}"/>
                                                <TextBlock Text="{Binding Name}" FontWeight="SemiBold" FontSize="12"
                                                           Foreground="{DynamicResource {x:Static vsshell:VsBrushes.ToolWindowTextKey}}"/>
                                            </StackPanel>
                                            <StackPanel Orientation="Horizontal" Margin="24,2,0,0">
                                                <TextBlock Text="{Binding CurrentVersion}"
                                                           Foreground="{DynamicResource {x:Static vsshell:VsBrushes.GrayTextKey}}" FontSize="11"/>
                                                <TextBlock Text=" â†’ " Foreground="{DynamicResource {x:Static vsshell:VsBrushes.GrayTextKey}}" FontSize="11"/>
                                                <TextBlock Text="{Binding LatestVersion}" Foreground="#4CAF50"
                                                           FontWeight="SemiBold" FontSize="11"/>
                                            </StackPanel>
                                        </StackPanel>

                                        <Button Grid.Column="1" Style="{StaticResource SmallBtn}"
                                                Content="Update" VerticalAlignment="Center"
                                                Click="UpdateOutdatedPackage_Click" Tag="{Binding Name}"/>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>

                    <StackPanel x:Name="NoUpdatesPanel" HorizontalAlignment="Center" VerticalAlignment="Center">
                        <imaging:CrispImage Width="32" Height="32" Margin="0,0,0,12"
                                            Moniker="{x:Static catalog:KnownMonikers.StatusOK}"
                                            HorizontalAlignment="Center"/>
                        <TextBlock Text="All packages are up to date!"
                                   Foreground="#4CAF50" FontWeight="SemiBold"
                                   HorizontalAlignment="Center"/>
                        <Button Style="{StaticResource SmallBtn}" Content="Check for Updates"
                                Margin="0,12,0,0" Click="OutdatedButton_Click"/>
                    </StackPanel>
                </Grid>
            </TabItem>
        </TabControl>

        <!-- Status Bar -->
        <Border Grid.Row="3" Background="{DynamicResource {x:Static vsshell:VsBrushes.CommandBarGradientKey}}"
                BorderBrush="{DynamicResource {x:Static vsshell:VsBrushes.CommandBarBorderKey}}" BorderThickness="0,1,0,0"
                Padding="8,4">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <TextBlock x:Name="StatusText" Grid.Column="0" Text="Ready" FontSize="11"
                           Foreground="{DynamicResource {x:Static vsshell:VsBrushes.GrayTextKey}}" VerticalAlignment="Center"/>
                <ProgressBar x:Name="ProgressBar" Grid.Column="1" Width="80" Height="10"
                             Visibility="Collapsed" IsIndeterminate="True"/>
            </Grid>
        </Border>
    </Grid>
</UserControl>
